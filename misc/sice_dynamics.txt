
u0=1.0*I1*c1 + 0.5*I2*(2*c1 + 2*c2) + 0.5*I3*(2*c1 + 2*c2 + 2*c3) + 0.5*I4*(2*c1 + 2*c2 + 2*c3 + 2*c4) + g*lg1*m1*cos(a1) + g*m2*(l1*cos(a1) + lg2*cos(a1 + a2)) + g*m3*(l1*cos(a1) + l2*cos(a1 + a2) + lg3*cos(a1 + a2 + a3)) + g*m4*(l1*cos(a1) + l2*cos(a1 + a2) + l3*cos(a1 + a2 + a3) + lg4*cos(a1 + a2 + a3 + a4)) + 0.5*m1*(2*c1*lg1**2*sin(a1)**2 + 2*c1*lg1**2*cos(a1)**2) - 0.5*m2*((-2*b1*l1*sin(a1) - 2*lg2*(b1 + b2)*sin(a1 + a2))*(b1*l1*cos(a1) + lg2*(b1 + b2)*cos(a1 + a2)) + (-b1*l1*sin(a1) - lg2*(b1 + b2)*sin(a1 + a2))*(-2*b1*l1*cos(a1) - 2*lg2*(b1 + b2)*cos(a1 + a2))) + 0.5*m2*((-2*l1*sin(a1) - 2*lg2*sin(a1 + a2))*(-b1**2*l1*cos(a1) - c1*l1*sin(a1) - lg2*(b1 + b2)**2*cos(a1 + a2) - lg2*(c1 + c2)*sin(a1 + a2)) + (2*l1*cos(a1) + 2*lg2*cos(a1 + a2))*(-b1**2*l1*sin(a1) + c1*l1*cos(a1) - lg2*(b1 + b2)**2*sin(a1 + a2) + lg2*(c1 + c2)*cos(a1 + a2)) + (-2*b1*l1*sin(a1) - 2*lg2*(b1 + b2)*sin(a1 + a2))*(b1*l1*cos(a1) + lg2*(b1 + b2)*cos(a1 + a2)) + (-b1*l1*sin(a1) - lg2*(b1 + b2)*sin(a1 + a2))*(-2*b1*l1*cos(a1) - 2*lg2*(b1 + b2)*cos(a1 + a2))) - 0.5*m3*((-2*b1*l1*sin(a1) - 2*l2*(b1 + b2)*sin(a1 + a2) - 2*lg3*(b1 + b2 + b3)*sin(a1 + a2 + a3))*(b1*l1*cos(a1) + l2*(b1 + b2)*cos(a1 + a2) + lg3*(b1 + b2 + b3)*cos(a1 + a2 + a3)) + (-b1*l1*sin(a1) - l2*(b1 + b2)*sin(a1 + a2) - lg3*(b1 + b2 + b3)*sin(a1 + a2 + a3))*(-2*b1*l1*cos(a1) - 2*l2*(b1 + b2)*cos(a1 + a2) - 2*lg3*(b1 + b2 + b3)*cos(a1 + a2 + a3))) + 0.5*m3*((-2*l1*sin(a1) - 2*l2*sin(a1 + a2) - 2*lg3*sin(a1 + a2 + a3))*(-b1**2*l1*cos(a1) - c1*l1*sin(a1) - l2*(b1 + b2)**2*cos(a1 + a2) - l2*(c1 + c2)*sin(a1 + a2) - lg3*(b1 + b2 + b3)**2*cos(a1 + a2 + a3) - lg3*(c1 + c2 + c3)*sin(a1 + a2 + a3)) + (2*l1*cos(a1) + 2*l2*cos(a1 + a2) + 2*lg3*cos(a1 + a2 + a3))*(-b1**2*l1*sin(a1) + c1*l1*cos(a1) - l2*(b1 + b2)**2*sin(a1 + a2) + l2*(c1 + c2)*cos(a1 + a2) - lg3*(b1 + b2 + b3)**2*sin(a1 + a2 + a3) + lg3*(c1 + c2 + c3)*cos(a1 + a2 + a3)) + (-2*b1*l1*sin(a1) - 2*l2*(b1 + b2)*sin(a1 + a2) - 2*lg3*(b1 + b2 + b3)*sin(a1 + a2 + a3))*(b1*l1*cos(a1) + l2*(b1 + b2)*cos(a1 + a2) + lg3*(b1 + b2 + b3)*cos(a1 + a2 + a3)) + (-b1*l1*sin(a1) - l2*(b1 + b2)*sin(a1 + a2) - lg3*(b1 + b2 + b3)*sin(a1 + a2 + a3))*(-2*b1*l1*cos(a1) - 2*l2*(b1 + b2)*cos(a1 + a2) - 2*lg3*(b1 + b2 + b3)*cos(a1 + a2 + a3))) - 0.5*m4*((-2*b1*l1*sin(a1) - 2*l2*(b1 + b2)*sin(a1 + a2) - 2*l3*(b1 + b2 + b3)*sin(a1 + a2 + a3) - 2*lg4*(b1 + b2 + b3 + b4)*sin(a1 + a2 + a3 + a4))*(b1*l1*cos(a1) + l2*(b1 + b2)*cos(a1 + a2) + l3*(b1 + b2 + b3)*cos(a1 + a2 + a3) + lg4*(b1 + b2 + b3 + b4)*cos(a1 + a2 + a3 + a4)) + (-b1*l1*sin(a1) - l2*(b1 + b2)*sin(a1 + a2) - l3*(b1 + b2 + b3)*sin(a1 + a2 + a3) - lg4*(b1 + b2 + b3 + b4)*sin(a1 + a2 + a3 + a4))*(-2*b1*l1*cos(a1) - 2*l2*(b1 + b2)*cos(a1 + a2) - 2*l3*(b1 + b2 + b3)*cos(a1 + a2 + a3) - 2*lg4*(b1 + b2 + b3 + b4)*cos(a1 + a2 + a3 + a4))) + 0.5*m4*((-2*l1*sin(a1) - 2*l2*sin(a1 + a2) - 2*l3*sin(a1 + a2 + a3) - 2*lg4*sin(a1 + a2 + a3 + a4))*(-b1**2*l1*cos(a1) - c1*l1*sin(a1) - l2*(b1 + b2)**2*cos(a1 + a2) - l2*(c1 + c2)*sin(a1 + a2) - l3*(b1 + b2 + b3)**2*cos(a1 + a2 + a3) - l3*(c1 + c2 + c3)*sin(a1 + a2 + a3) - lg4*(b1 + b2 + b3 + b4)**2*cos(a1 + a2 + a3 + a4) - lg4*(c1 + c2 + c3 + c4)*sin(a1 + a2 + a3 + a4)) + (2*l1*cos(a1) + 2*l2*cos(a1 + a2) + 2*l3*cos(a1 + a2 + a3) + 2*lg4*cos(a1 + a2 + a3 + a4))*(-b1**2*l1*sin(a1) + c1*l1*cos(a1) - l2*(b1 + b2)**2*sin(a1 + a2) + l2*(c1 + c2)*cos(a1 + a2) - l3*(b1 + b2 + b3)**2*sin(a1 + a2 + a3) + l3*(c1 + c2 + c3)*cos(a1 + a2 + a3) - lg4*(b1 + b2 + b3 + b4)**2*sin(a1 + a2 + a3 + a4) + lg4*(c1 + c2 + c3 + c4)*cos(a1 + a2 + a3 + a4)) + (-2*b1*l1*sin(a1) - 2*l2*(b1 + b2)*sin(a1 + a2) - 2*l3*(b1 + b2 + b3)*sin(a1 + a2 + a3) - 2*lg4*(b1 + b2 + b3 + b4)*sin(a1 + a2 + a3 + a4))*(b1*l1*cos(a1) + l2*(b1 + b2)*cos(a1 + a2) + l3*(b1 + b2 + b3)*cos(a1 + a2 + a3) + lg4*(b1 + b2 + b3 + b4)*cos(a1 + a2 + a3 + a4)) + (-b1*l1*sin(a1) - l2*(b1 + b2)*sin(a1 + a2) - l3*(b1 + b2 + b3)*sin(a1 + a2 + a3) - lg4*(b1 + b2 + b3 + b4)*sin(a1 + a2 + a3 + a4))*(-2*b1*l1*cos(a1) - 2*l2*(b1 + b2)*cos(a1 + a2) - 2*l3*(b1 + b2 + b3)*cos(a1 + a2 + a3) - 2*lg4*(b1 + b2 + b3 + b4)*cos(a1 + a2 + a3 + a4)))
u1=0.5*I2*(2*c1 + 2*c2) + 0.5*I3*(2*c1 + 2*c2 + 2*c3) + 0.5*I4*(2*c1 + 2*c2 + 2*c3 + 2*c4) + g*lg2*m2*cos(a1 + a2) + g*m3*(l2*cos(a1 + a2) + lg3*cos(a1 + a2 + a3)) + g*m4*(l2*cos(a1 + a2) + l3*cos(a1 + a2 + a3) + lg4*cos(a1 + a2 + a3 + a4)) - 0.5*m2*(-2*lg2*(b1 + b2)*(-b1*l1*sin(a1) - lg2*(b1 + b2)*sin(a1 + a2))*cos(a1 + a2) - 2*lg2*(b1 + b2)*(b1*l1*cos(a1) + lg2*(b1 + b2)*cos(a1 + a2))*sin(a1 + a2)) + 0.5*m2*(-2*lg2*(b1 + b2)*(-b1*l1*sin(a1) - lg2*(b1 + b2)*sin(a1 + a2))*cos(a1 + a2) - 2*lg2*(b1 + b2)*(b1*l1*cos(a1) + lg2*(b1 + b2)*cos(a1 + a2))*sin(a1 + a2) + 2*lg2*(-b1**2*l1*sin(a1) + c1*l1*cos(a1) - lg2*(b1 + b2)**2*sin(a1 + a2) + lg2*(c1 + c2)*cos(a1 + a2))*cos(a1 + a2) - 2*lg2*(-b1**2*l1*cos(a1) - c1*l1*sin(a1) - lg2*(b1 + b2)**2*cos(a1 + a2) - lg2*(c1 + c2)*sin(a1 + a2))*sin(a1 + a2)) - 0.5*m3*((-2*l2*(b1 + b2)*sin(a1 + a2) - 2*lg3*(b1 + b2 + b3)*sin(a1 + a2 + a3))*(b1*l1*cos(a1) + l2*(b1 + b2)*cos(a1 + a2) + lg3*(b1 + b2 + b3)*cos(a1 + a2 + a3)) + (-2*l2*(b1 + b2)*cos(a1 + a2) - 2*lg3*(b1 + b2 + b3)*cos(a1 + a2 + a3))*(-b1*l1*sin(a1) - l2*(b1 + b2)*sin(a1 + a2) - lg3*(b1 + b2 + b3)*sin(a1 + a2 + a3))) + 0.5*m3*((-2*l2*sin(a1 + a2) - 2*lg3*sin(a1 + a2 + a3))*(-b1**2*l1*cos(a1) - c1*l1*sin(a1) - l2*(b1 + b2)**2*cos(a1 + a2) - l2*(c1 + c2)*sin(a1 + a2) - lg3*(b1 + b2 + b3)**2*cos(a1 + a2 + a3) - lg3*(c1 + c2 + c3)*sin(a1 + a2 + a3)) + (2*l2*cos(a1 + a2) + 2*lg3*cos(a1 + a2 + a3))*(-b1**2*l1*sin(a1) + c1*l1*cos(a1) - l2*(b1 + b2)**2*sin(a1 + a2) + l2*(c1 + c2)*cos(a1 + a2) - lg3*(b1 + b2 + b3)**2*sin(a1 + a2 + a3) + lg3*(c1 + c2 + c3)*cos(a1 + a2 + a3)) + (-2*l2*(b1 + b2)*sin(a1 + a2) - 2*lg3*(b1 + b2 + b3)*sin(a1 + a2 + a3))*(b1*l1*cos(a1) + l2*(b1 + b2)*cos(a1 + a2) + lg3*(b1 + b2 + b3)*cos(a1 + a2 + a3)) + (-2*l2*(b1 + b2)*cos(a1 + a2) - 2*lg3*(b1 + b2 + b3)*cos(a1 + a2 + a3))*(-b1*l1*sin(a1) - l2*(b1 + b2)*sin(a1 + a2) - lg3*(b1 + b2 + b3)*sin(a1 + a2 + a3))) - 0.5*m4*((-2*l2*(b1 + b2)*sin(a1 + a2) - 2*l3*(b1 + b2 + b3)*sin(a1 + a2 + a3) - 2*lg4*(b1 + b2 + b3 + b4)*sin(a1 + a2 + a3 + a4))*(b1*l1*cos(a1) + l2*(b1 + b2)*cos(a1 + a2) + l3*(b1 + b2 + b3)*cos(a1 + a2 + a3) + lg4*(b1 + b2 + b3 + b4)*cos(a1 + a2 + a3 + a4)) + (-2*l2*(b1 + b2)*cos(a1 + a2) - 2*l3*(b1 + b2 + b3)*cos(a1 + a2 + a3) - 2*lg4*(b1 + b2 + b3 + b4)*cos(a1 + a2 + a3 + a4))*(-b1*l1*sin(a1) - l2*(b1 + b2)*sin(a1 + a2) - l3*(b1 + b2 + b3)*sin(a1 + a2 + a3) - lg4*(b1 + b2 + b3 + b4)*sin(a1 + a2 + a3 + a4))) + 0.5*m4*((-2*l2*sin(a1 + a2) - 2*l3*sin(a1 + a2 + a3) - 2*lg4*sin(a1 + a2 + a3 + a4))*(-b1**2*l1*cos(a1) - c1*l1*sin(a1) - l2*(b1 + b2)**2*cos(a1 + a2) - l2*(c1 + c2)*sin(a1 + a2) - l3*(b1 + b2 + b3)**2*cos(a1 + a2 + a3) - l3*(c1 + c2 + c3)*sin(a1 + a2 + a3) - lg4*(b1 + b2 + b3 + b4)**2*cos(a1 + a2 + a3 + a4) - lg4*(c1 + c2 + c3 + c4)*sin(a1 + a2 + a3 + a4)) + (2*l2*cos(a1 + a2) + 2*l3*cos(a1 + a2 + a3) + 2*lg4*cos(a1 + a2 + a3 + a4))*(-b1**2*l1*sin(a1) + c1*l1*cos(a1) - l2*(b1 + b2)**2*sin(a1 + a2) + l2*(c1 + c2)*cos(a1 + a2) - l3*(b1 + b2 + b3)**2*sin(a1 + a2 + a3) + l3*(c1 + c2 + c3)*cos(a1 + a2 + a3) - lg4*(b1 + b2 + b3 + b4)**2*sin(a1 + a2 + a3 + a4) + lg4*(c1 + c2 + c3 + c4)*cos(a1 + a2 + a3 + a4)) + (-2*l2*(b1 + b2)*sin(a1 + a2) - 2*l3*(b1 + b2 + b3)*sin(a1 + a2 + a3) - 2*lg4*(b1 + b2 + b3 + b4)*sin(a1 + a2 + a3 + a4))*(b1*l1*cos(a1) + l2*(b1 + b2)*cos(a1 + a2) + l3*(b1 + b2 + b3)*cos(a1 + a2 + a3) + lg4*(b1 + b2 + b3 + b4)*cos(a1 + a2 + a3 + a4)) + (-2*l2*(b1 + b2)*cos(a1 + a2) - 2*l3*(b1 + b2 + b3)*cos(a1 + a2 + a3) - 2*lg4*(b1 + b2 + b3 + b4)*cos(a1 + a2 + a3 + a4))*(-b1*l1*sin(a1) - l2*(b1 + b2)*sin(a1 + a2) - l3*(b1 + b2 + b3)*sin(a1 + a2 + a3) - lg4*(b1 + b2 + b3 + b4)*sin(a1 + a2 + a3 + a4)))
u2=0.5*I3*(2*c1 + 2*c2 + 2*c3) + 0.5*I4*(2*c1 + 2*c2 + 2*c3 + 2*c4) + g*lg3*m3*cos(a1 + a2 + a3) + g*m4*(l3*cos(a1 + a2 + a3) + lg4*cos(a1 + a2 + a3 + a4)) - 0.5*m3*(-2*lg3*(b1 + b2 + b3)*(-b1*l1*sin(a1) - l2*(b1 + b2)*sin(a1 + a2) - lg3*(b1 + b2 + b3)*sin(a1 + a2 + a3))*cos(a1 + a2 + a3) - 2*lg3*(b1 + b2 + b3)*(b1*l1*cos(a1) + l2*(b1 + b2)*cos(a1 + a2) + lg3*(b1 + b2 + b3)*cos(a1 + a2 + a3))*sin(a1 + a2 + a3)) + 0.5*m3*(-2*lg3*(b1 + b2 + b3)*(-b1*l1*sin(a1) - l2*(b1 + b2)*sin(a1 + a2) - lg3*(b1 + b2 + b3)*sin(a1 + a2 + a3))*cos(a1 + a2 + a3) - 2*lg3*(b1 + b2 + b3)*(b1*l1*cos(a1) + l2*(b1 + b2)*cos(a1 + a2) + lg3*(b1 + b2 + b3)*cos(a1 + a2 + a3))*sin(a1 + a2 + a3) + 2*lg3*(-b1**2*l1*sin(a1) + c1*l1*cos(a1) - l2*(b1 + b2)**2*sin(a1 + a2) + l2*(c1 + c2)*cos(a1 + a2) - lg3*(b1 + b2 + b3)**2*sin(a1 + a2 + a3) + lg3*(c1 + c2 + c3)*cos(a1 + a2 + a3))*cos(a1 + a2 + a3) - 2*lg3*(-b1**2*l1*cos(a1) - c1*l1*sin(a1) - l2*(b1 + b2)**2*cos(a1 + a2) - l2*(c1 + c2)*sin(a1 + a2) - lg3*(b1 + b2 + b3)**2*cos(a1 + a2 + a3) - lg3*(c1 + c2 + c3)*sin(a1 + a2 + a3))*sin(a1 + a2 + a3)) - 0.5*m4*((-2*l3*(b1 + b2 + b3)*sin(a1 + a2 + a3) - 2*lg4*(b1 + b2 + b3 + b4)*sin(a1 + a2 + a3 + a4))*(b1*l1*cos(a1) + l2*(b1 + b2)*cos(a1 + a2) + l3*(b1 + b2 + b3)*cos(a1 + a2 + a3) + lg4*(b1 + b2 + b3 + b4)*cos(a1 + a2 + a3 + a4)) + (-2*l3*(b1 + b2 + b3)*cos(a1 + a2 + a3) - 2*lg4*(b1 + b2 + b3 + b4)*cos(a1 + a2 + a3 + a4))*(-b1*l1*sin(a1) - l2*(b1 + b2)*sin(a1 + a2) - l3*(b1 + b2 + b3)*sin(a1 + a2 + a3) - lg4*(b1 + b2 + b3 + b4)*sin(a1 + a2 + a3 + a4))) + 0.5*m4*((-2*l3*sin(a1 + a2 + a3) - 2*lg4*sin(a1 + a2 + a3 + a4))*(-b1**2*l1*cos(a1) - c1*l1*sin(a1) - l2*(b1 + b2)**2*cos(a1 + a2) - l2*(c1 + c2)*sin(a1 + a2) - l3*(b1 + b2 + b3)**2*cos(a1 + a2 + a3) - l3*(c1 + c2 + c3)*sin(a1 + a2 + a3) - lg4*(b1 + b2 + b3 + b4)**2*cos(a1 + a2 + a3 + a4) - lg4*(c1 + c2 + c3 + c4)*sin(a1 + a2 + a3 + a4)) + (2*l3*cos(a1 + a2 + a3) + 2*lg4*cos(a1 + a2 + a3 + a4))*(-b1**2*l1*sin(a1) + c1*l1*cos(a1) - l2*(b1 + b2)**2*sin(a1 + a2) + l2*(c1 + c2)*cos(a1 + a2) - l3*(b1 + b2 + b3)**2*sin(a1 + a2 + a3) + l3*(c1 + c2 + c3)*cos(a1 + a2 + a3) - lg4*(b1 + b2 + b3 + b4)**2*sin(a1 + a2 + a3 + a4) + lg4*(c1 + c2 + c3 + c4)*cos(a1 + a2 + a3 + a4)) + (-2*l3*(b1 + b2 + b3)*sin(a1 + a2 + a3) - 2*lg4*(b1 + b2 + b3 + b4)*sin(a1 + a2 + a3 + a4))*(b1*l1*cos(a1) + l2*(b1 + b2)*cos(a1 + a2) + l3*(b1 + b2 + b3)*cos(a1 + a2 + a3) + lg4*(b1 + b2 + b3 + b4)*cos(a1 + a2 + a3 + a4)) + (-2*l3*(b1 + b2 + b3)*cos(a1 + a2 + a3) - 2*lg4*(b1 + b2 + b3 + b4)*cos(a1 + a2 + a3 + a4))*(-b1*l1*sin(a1) - l2*(b1 + b2)*sin(a1 + a2) - l3*(b1 + b2 + b3)*sin(a1 + a2 + a3) - lg4*(b1 + b2 + b3 + b4)*sin(a1 + a2 + a3 + a4)))
u3=0.5*I4*(2*c1 + 2*c2 + 2*c3 + 2*c4) + g*lg4*m4*cos(a1 + a2 + a3 + a4) - 0.5*m4*(-2*lg4*(b1 + b2 + b3 + b4)*(-b1*l1*sin(a1) - l2*(b1 + b2)*sin(a1 + a2) - l3*(b1 + b2 + b3)*sin(a1 + a2 + a3) - lg4*(b1 + b2 + b3 + b4)*sin(a1 + a2 + a3 + a4))*cos(a1 + a2 + a3 + a4) - 2*lg4*(b1 + b2 + b3 + b4)*(b1*l1*cos(a1) + l2*(b1 + b2)*cos(a1 + a2) + l3*(b1 + b2 + b3)*cos(a1 + a2 + a3) + lg4*(b1 + b2 + b3 + b4)*cos(a1 + a2 + a3 + a4))*sin(a1 + a2 + a3 + a4)) + 0.5*m4*(-2*lg4*(b1 + b2 + b3 + b4)*(-b1*l1*sin(a1) - l2*(b1 + b2)*sin(a1 + a2) - l3*(b1 + b2 + b3)*sin(a1 + a2 + a3) - lg4*(b1 + b2 + b3 + b4)*sin(a1 + a2 + a3 + a4))*cos(a1 + a2 + a3 + a4) - 2*lg4*(b1 + b2 + b3 + b4)*(b1*l1*cos(a1) + l2*(b1 + b2)*cos(a1 + a2) + l3*(b1 + b2 + b3)*cos(a1 + a2 + a3) + lg4*(b1 + b2 + b3 + b4)*cos(a1 + a2 + a3 + a4))*sin(a1 + a2 + a3 + a4) + 2*lg4*(-b1**2*l1*sin(a1) + c1*l1*cos(a1) - l2*(b1 + b2)**2*sin(a1 + a2) + l2*(c1 + c2)*cos(a1 + a2) - l3*(b1 + b2 + b3)**2*sin(a1 + a2 + a3) + l3*(c1 + c2 + c3)*cos(a1 + a2 + a3) - lg4*(b1 + b2 + b3 + b4)**2*sin(a1 + a2 + a3 + a4) + lg4*(c1 + c2 + c3 + c4)*cos(a1 + a2 + a3 + a4))*cos(a1 + a2 + a3 + a4) - 2*lg4*(-b1**2*l1*cos(a1) - c1*l1*sin(a1) - l2*(b1 + b2)**2*cos(a1 + a2) - l2*(c1 + c2)*sin(a1 + a2) - l3*(b1 + b2 + b3)**2*cos(a1 + a2 + a3) - l3*(c1 + c2 + c3)*sin(a1 + a2 + a3) - lg4*(b1 + b2 + b3 + b4)**2*cos(a1 + a2 + a3 + a4) - lg4*(c1 + c2 + c3 + c4)*sin(a1 + a2 + a3 + a4))*sin(a1 + a2 + a3 + a4))